
<div class="relative z-30" id="modal-comments" aria-labelledby="modal-title" role="dialog"
    aria-modal="true">
    <div class="fixed inset-0 bg-gray-500/75 transition-opacity" (click)="closeModal()" aria-hidden="true">
    <div class="fixed inset-0 z-10 w-screen p-2 overflow-y-auto">
        <div class="flex min-h-full w-full items-center justify-center text-center sm:items-center sm:p-0">
            <div (click)="$event.stopPropagation()" class="relative transform overflow-hidden rounded-lg bg-white  text-left shadow-xl transition-all sm:my-8 
                sm:w-[500px] sm:max-w-[500px] ">
                <div class="sm:flex sm:items-start">
                    <div class=" text-center sm:mt-0 sm:text-left w-full">
                        <div class=" border-b-1 p-4 border-gray-200">
                            <h3 class=" text-lg font-medium leading-6 text-gray-900" id="modal-title">Comments</h3>
                        </div>
                        <div id="comments" class="max-h-[360px] overflow-y-auto">
                            @for (comment of comments; track $index){
                                <div (mouseover)="showOptionsComment(comment.comment_id)" (mouseout)="hideOptionsComment(comment.comment_id)" class="p-3 mb-2 w-full flex flex-col transition-normal ease-in   hover:bg-gray-100">
                                    <div class="flex flex-row items-center">
                                        <div class="w-[33px] h-[31px] rounded-full bg-purple-300 border-1 border-gray-300"></div>
                                        <div class="ml-2 w-full flex flex-row justify-between items-center">
                                            <div>
                                            <span class="font-semibold text-[14px]">
                                                    {{user.get(comment.user_id)?.first_name}} {{user.get(comment.user_id)?.last_name}}</span> 
                                            <span class="text-[12px] text-gray-500 ml-2"> 
                                                {{commentsDate.get(comment.comment_id)}}
                                               </span>
                                               <span class="text-[12px] text-gray-500 ml-2"> 
                                                {{comment.is_edited ? 'Edited' : ''}}
                                               </span>
                                            </div>
                                            @if(this.userUUID == comment.user_id){
                                            <div id="options-{{comment.comment_id}}"  class="hidden flex-row items-center   text-gray-400">   
                                                <div class="hover:text-purple-500" (click)="openEditCommentBox(comment.comment_id)">
                                                    <ng-icon title="Edit" class="cursor-pointer mr-2" name="heroPencilSquare"  size="17px" >
                                                    </ng-icon>                                                                                                        
                                                </div>    
                                                <div class="hover:text-red-500">
                                                    <ng-icon title="Delete"  (click)="deleteComment(comment.comment_id)" class="cursor-pointer" name="heroTrash" size="17px" ></ng-icon> 
                                                </div>                                      
                                            </div>
                                            }
                                            </div>  
                                    </div>
                                    <div class="mt-1 ml-10"> 
                                        <p id="comment-{{comment.comment_id}}" class="text-[14px]">{{comment.content}}</p>
                                        @if(showEditComment.get(comment.comment_id) ){
                                            <div class="flex flex-col items-center border-1 p-2 border-gray-200 rounded-[10px]">
                                                <textarea id="edit-comment-{{comment.comment_id}}" type="text" placeholder="Edit comment" class="p-2 w-full  
                                                outline-0 resize-none h-[80px]  placeholder:text-gray-500 text-[14px] " value="{{comment.content}}"></textarea>
                                                <div class="flex flex-row justify-end w-full">
                                                <button (click)="updateComment(comment.comment_id)" class="bg-gray-300 hover:bg-purple-500 transition-colors text-[16px] cursor-pointer text-white inline-flex items-center justify-center
                                                 rounded-[10px] p-2">
                                                    <ng-icon size="18px" name="heroPaperAirplane"></ng-icon>
                                                </button>
                                                </div>
                                            </div>                                            
                                        }
                                       
                                    </div>
                                </div>
                            }
                            
                        </div>
                        <div class="p-2">
                        <div class="p-2 border-2 transition-colors border-gray-200 w-full rounded-[10px]">
                        <form [formGroup]="commentForm" (submit)="sendComment()" >
                            <textarea formControlName="content" placeholder="Add a comment" class="resize-none p-2 w-full h-[50px] outline-0 placeholder:text-gray-500 text-[14px] "></textarea>
                            <div class="flex flex-row justify-end">
                                <button type="submit" class="bg-gray-300 hover:bg-purple-500 transition-colors text-[16px] cursor-pointer text-white inline-flex items-center justify-center
                                 rounded-[10px] p-2">
                                    <ng-icon size="18px" name="heroPaperAirplane"></ng-icon>
                                </button>
                            </div>                            
                        </form>             
                        </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</div>